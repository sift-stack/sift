from __future__ import annotations

import logging
from typing import TYPE_CHECKING, Any, cast

from sift.resource_attribute.v1.resource_attribute_pb2 import (
    ArchiveResourceAttributeEnumValueRequest,
    ArchiveResourceAttributeEnumValueResponse,
    ArchiveResourceAttributeKeyRequest,
    ArchiveResourceAttributeRequest,
    BatchArchiveResourceAttributeEnumValuesRequest,
    BatchArchiveResourceAttributeEnumValuesResponse,
    BatchArchiveResourceAttributeKeysRequest,
    BatchArchiveResourceAttributeKeysRequest,
    BatchArchiveResourceAttributesRequest,
    BatchCreateResourceAttributesRequest,
    BatchCreateResourceAttributesResponse,
    BatchUnarchiveResourceAttributeEnumValuesRequest,
    BatchUnarchiveResourceAttributeKeysRequest,
    BatchUnarchiveResourceAttributesRequest,
    CreateResourceAttributeEnumValueResponse,
    CreateResourceAttributeKeyResponse,
    CreateResourceAttributeResponse,
    GetResourceAttributeEnumValueRequest,
    GetResourceAttributeEnumValueResponse,
    GetResourceAttributeKeyRequest,
    GetResourceAttributeKeyResponse,
    GetResourceAttributeRequest,
    GetResourceAttributeResponse,
    ListResourceAttributeEnumValuesRequest,
    ListResourceAttributeEnumValuesResponse,
    ListResourceAttributeKeysRequest,
    ListResourceAttributeKeysResponse,
    ListResourceAttributesByEntityRequest,
    ListResourceAttributesByEntityResponse,
    ListResourceAttributesRequest,
    ListResourceAttributesResponse,
    ResourceAttributeEntityIdentifier,
    UnarchiveResourceAttributeEnumValueRequest,
    UnarchiveResourceAttributeKeyRequest,
    UnarchiveResourceAttributeRequest,
    UpdateResourceAttributeEnumValueRequest,
    UpdateResourceAttributeEnumValueResponse,
    UpdateResourceAttributeKeyRequest,
    UpdateResourceAttributeKeyResponse,
)
from sift.resource_attribute.v1.resource_attribute_pb2_grpc import ResourceAttributeServiceStub

from sift_client._internal.low_level_wrappers.base import LowLevelClientBase
from sift_client.sift_types.resource_attribute import (
    ResourceAttribute,
    ResourceAttributeCreate,
    ResourceAttributeEnumValue,
    ResourceAttributeEnumValueCreate,
    ResourceAttributeEnumValueUpdate,
    ResourceAttributeKey,
    ResourceAttributeKeyCreate,
    ResourceAttributeKeyUpdate,
)
from sift_client.transport import WithGrpcClient

if TYPE_CHECKING:
    from sift_client.transport.grpc_transport import GrpcClient

# Configure logging
logger = logging.getLogger(__name__)


class ResourceAttributeLowLevelClient(LowLevelClientBase, WithGrpcClient):
    """Low-level client for the ResourceAttributeService.

    This class provides a thin wrapper around the autogenerated bindings for the ResourceAttributeService.
    """

    def __init__(self, grpc_client: GrpcClient):
        """Initialize the ResourceAttributeLowLevelClient.

        Args:
            grpc_client: The gRPC client to use for making API calls.
        """
        super().__init__(grpc_client)

    # Resource Attribute Key methods

    async def create_resource_attribute_key(
        self,
        display_name: str,
        description: str | None,
        key_type: int,
        initial_enum_values: list[dict] | None = None,
    ) -> ResourceAttributeKey:
        """Create a new resource attribute key.

        Args:
            display_name: The display name of the key.
            description: Optional description.
            key_type: The ResourceAttributeKeyType enum value.
            initial_enum_values: Optional list of initial enum values.

        Returns:
            The created ResourceAttributeKey.
        """
        create = ResourceAttributeKeyCreate(
            display_name=display_name,
            description=description,
            type=key_type,
            initial_enum_values=initial_enum_values,
        )
        request = create.to_proto()

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).CreateResourceAttributeKey(request)
        grpc_key = cast("CreateResourceAttributeKeyResponse", response).resource_attribute_key
        return ResourceAttributeKey._from_proto(grpc_key)

    async def get_resource_attribute_key(self, key_id: str) -> ResourceAttributeKey:
        """Get a resource attribute key by ID.

        Args:
            key_id: The resource attribute key ID.

        Returns:
            The ResourceAttributeKey.
        """
        request = GetResourceAttributeKeyRequest(resource_attribute_key_id=key_id)
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).GetResourceAttributeKey(request)
        grpc_key = cast("GetResourceAttributeKeyResponse", response).resource_attribute_key
        return ResourceAttributeKey._from_proto(grpc_key)

    async def list_resource_attribute_keys(
        self,
        *,
        page_size: int | None = None,
        page_token: str | None = None,
        query_filter: str | None = None,
        order_by: str | None = None,
        include_archived: bool = False,
    ) -> tuple[list[ResourceAttributeKey], str]:
        """List resource attribute keys with optional filtering and pagination.

        Args:
            page_size: The maximum number of keys to return.
            page_token: A page token for pagination.
            query_filter: A CEL filter string.
            order_by: How to order the retrieved keys.
            include_archived: Whether to include archived keys.

        Returns:
            A tuple of (keys, next_page_token).
        """
        request_kwargs: dict[str, Any] = {
            "include_archived": include_archived,
        }
        if page_size is not None:
            request_kwargs["page_size"] = page_size
        if page_token is not None:
            request_kwargs["page_token"] = page_token
        if query_filter is not None:
            request_kwargs["filter"] = query_filter
        if order_by is not None:
            request_kwargs["order_by"] = order_by

        request = ListResourceAttributeKeysRequest(**request_kwargs)
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ListResourceAttributeKeys(request)
        response = cast("ListResourceAttributeKeysResponse", response)

        keys = [
            ResourceAttributeKey._from_proto(key) for key in response.resource_attribute_keys
        ]
        return keys, response.next_page_token

    async def list_all_resource_attribute_keys(
        self,
        *,
        query_filter: str | None = None,
        order_by: str | None = None,
        include_archived: bool = False,
        max_results: int | None = None,
    ) -> list[ResourceAttributeKey]:
        """List all resource attribute keys with optional filtering.

        Args:
            query_filter: A CEL filter string.
            order_by: How to order the retrieved keys.
            include_archived: Whether to include archived keys.
            max_results: Maximum number of results to return.

        Returns:
            A list of all matching keys.
        """
        return await self._handle_pagination(
            self.list_resource_attribute_keys,
            kwargs={"include_archived": include_archived, "query_filter": query_filter},
            order_by=order_by,
            max_results=max_results,
        )

    async def update_resource_attribute_key(
        self, key: str | ResourceAttributeKey, update: ResourceAttributeKeyUpdate | dict
    ) -> ResourceAttributeKey:
        """Update a resource attribute key.

        Args:
            key: The ResourceAttributeKey or key ID to update.
            update: Updates to apply to the key.

        Returns:
            The updated ResourceAttributeKey.
        """
        key_id = key._id_or_error if isinstance(key, ResourceAttributeKey) else key
        if isinstance(update, dict):
            update = ResourceAttributeKeyUpdate.model_validate(update)
        update.resource_id = key_id

        proto, mask = update.to_proto_with_mask()
        request = UpdateResourceAttributeKeyRequest(
            resource_attribute_key_id=key_id, update_mask=mask
        )
        if update.display_name is not None:
            request.display_name = update.display_name
        if update.description is not None:
            request.description = update.description

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).UpdateResourceAttributeKey(request)
        grpc_key = cast("UpdateResourceAttributeKeyResponse", response).resource_attribute_key
        return ResourceAttributeKey._from_proto(grpc_key)

    async def archive_resource_attribute_key(self, key_id: str) -> None:
        """Archive a resource attribute key.

        Args:
            key_id: The resource attribute key ID to archive.
        """
        request = ArchiveResourceAttributeKeyRequest(resource_attribute_key_id=key_id)
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ArchiveResourceAttributeKey(request)

    async def unarchive_resource_attribute_key(self, key_id: str) -> None:
        """Unarchive a resource attribute key.

        Args:
            key_id: The resource attribute key ID to unarchive.
        """
        request = UnarchiveResourceAttributeKeyRequest(resource_attribute_key_id=key_id)
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).UnarchiveResourceAttributeKey(request)

    async def batch_archive_resource_attribute_keys(self, key_ids: list[str]) -> None:
        """Archive multiple resource attribute keys.

        Args:
            key_ids: List of resource attribute key IDs to archive.
        """
        request = BatchArchiveResourceAttributeKeysRequest(
            resource_attribute_key_ids=key_ids
        )
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchArchiveResourceAttributeKeys(request)

    async def batch_unarchive_resource_attribute_keys(self, key_ids: list[str]) -> None:
        """Unarchive multiple resource attribute keys.

        Args:
            key_ids: List of resource attribute key IDs to unarchive.
        """
        request = BatchUnarchiveResourceAttributeKeysRequest(
            resource_attribute_key_ids=key_ids
        )
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchUnarchiveResourceAttributeKeys(request)

    # Resource Attribute Enum Value methods

    async def create_resource_attribute_enum_value(
        self, key_id: str, display_name: str, description: str | None = None
    ) -> ResourceAttributeEnumValue:
        """Create a new resource attribute enum value.

        Args:
            key_id: The resource attribute key ID.
            display_name: The display name of the enum value.
            description: Optional description.

        Returns:
            The created ResourceAttributeEnumValue.
        """
        create = ResourceAttributeEnumValueCreate(
            resource_attribute_key_id=key_id,
            display_name=display_name,
            description=description,
        )
        request = create.to_proto()

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).CreateResourceAttributeEnumValue(request)
        grpc_enum_value = cast(
            "CreateResourceAttributeEnumValueResponse", response
        ).resource_attribute_enum_value
        return ResourceAttributeEnumValue._from_proto(grpc_enum_value)

    async def get_resource_attribute_enum_value(
        self, enum_value_id: str
    ) -> ResourceAttributeEnumValue:
        """Get a resource attribute enum value by ID.

        Args:
            enum_value_id: The resource attribute enum value ID.

        Returns:
            The ResourceAttributeEnumValue.
        """
        request = GetResourceAttributeEnumValueRequest(
            resource_attribute_enum_value_id=enum_value_id
        )
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).GetResourceAttributeEnumValue(request)
        grpc_enum_value = cast(
            "GetResourceAttributeEnumValueResponse", response
        ).resource_attribute_enum_value
        return ResourceAttributeEnumValue._from_proto(grpc_enum_value)

    async def list_resource_attribute_enum_values(
        self,
        key_id: str,
        *,
        page_size: int | None = None,
        page_token: str | None = None,
        query_filter: str | None = None,
        order_by: str | None = None,
        include_archived: bool = False,
    ) -> tuple[list[ResourceAttributeEnumValue], str]:
        """List resource attribute enum values for a key with optional filtering and pagination.

        Args:
            key_id: The resource attribute key ID.
            page_size: The maximum number of enum values to return.
            page_token: A page token for pagination.
            query_filter: A CEL filter string.
            order_by: How to order the retrieved enum values.
            include_archived: Whether to include archived enum values.

        Returns:
            A tuple of (enum_values, next_page_token).
        """
        request_kwargs: dict[str, Any] = {
            "resource_attribute_key_id": key_id,
            "include_archived": include_archived,
        }
        if page_size is not None:
            request_kwargs["page_size"] = page_size
        if page_token is not None:
            request_kwargs["page_token"] = page_token
        if query_filter is not None:
            request_kwargs["filter"] = query_filter
        if order_by is not None:
            request_kwargs["order_by"] = order_by

        request = ListResourceAttributeEnumValuesRequest(**request_kwargs)
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ListResourceAttributeEnumValues(request)
        response = cast("ListResourceAttributeEnumValuesResponse", response)

        enum_values = [
            ResourceAttributeEnumValue._from_proto(val)
            for val in response.resource_attribute_enum_values
        ]
        return enum_values, response.next_page_token

    async def list_all_resource_attribute_enum_values(
        self,
        key_id: str,
        *,
        query_filter: str | None = None,
        order_by: str | None = None,
        include_archived: bool = False,
        max_results: int | None = None,
    ) -> list[ResourceAttributeEnumValue]:
        """List all resource attribute enum values for a key with optional filtering.

        Args:
            key_id: The resource attribute key ID.
            query_filter: A CEL filter string.
            order_by: How to order the retrieved enum values.
            include_archived: Whether to include archived enum values.
            max_results: Maximum number of results to return.

        Returns:
            A list of all matching enum values.
        """
        return await self._handle_pagination(
            self.list_resource_attribute_enum_values,
            kwargs={
                "key_id": key_id,
                "query_filter": query_filter,
                "include_archived": include_archived,
            },
            order_by=order_by,
            max_results=max_results,
        )

    async def update_resource_attribute_enum_value(
        self,
        enum_value: str | ResourceAttributeEnumValue,
        update: ResourceAttributeEnumValueUpdate | dict,
    ) -> ResourceAttributeEnumValue:
        """Update a resource attribute enum value.

        Args:
            enum_value: The ResourceAttributeEnumValue or enum value ID to update.
            update: Updates to apply to the enum value.

        Returns:
            The updated ResourceAttributeEnumValue.
        """
        enum_value_id = (
            enum_value._id_or_error if isinstance(enum_value, ResourceAttributeEnumValue) else enum_value
        )
        if isinstance(update, dict):
            update = ResourceAttributeEnumValueUpdate.model_validate(update)
        update.resource_id = enum_value_id

        proto, mask = update.to_proto_with_mask()
        request = UpdateResourceAttributeEnumValueRequest(
            resource_attribute_enum_value_id=enum_value_id, update_mask=mask
        )
        if update.display_name is not None:
            request.display_name = update.display_name
        if update.description is not None:
            request.description = update.description

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).UpdateResourceAttributeEnumValue(request)
        grpc_enum_value = cast(
            "UpdateResourceAttributeEnumValueResponse", response
        ).resource_attribute_enum_value
        return ResourceAttributeEnumValue._from_proto(grpc_enum_value)

    async def archive_resource_attribute_enum_value(
        self, enum_value_id: str, replacement_enum_value_id: str
    ) -> int:
        """Archive a resource attribute enum value and migrate attributes.

        Args:
            enum_value_id: The enum value ID to archive.
            replacement_enum_value_id: The enum value ID to migrate attributes to.

        Returns:
            The number of resource attributes migrated.
        """
        request = ArchiveResourceAttributeEnumValueRequest(
            archived_enum_value_id=enum_value_id,
            replacement_enum_value_id=replacement_enum_value_id,
        )
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ArchiveResourceAttributeEnumValue(request)
        return cast("ArchiveResourceAttributeEnumValueResponse", response).resource_attributes_migrated

    async def unarchive_resource_attribute_enum_value(self, enum_value_id: str) -> None:
        """Unarchive a resource attribute enum value.

        Args:
            enum_value_id: The resource attribute enum value ID to unarchive.
        """
        request = UnarchiveResourceAttributeEnumValueRequest(
            resource_attribute_enum_value_id=enum_value_id
        )
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).UnarchiveResourceAttributeEnumValue(request)

    async def batch_archive_resource_attribute_enum_values(
        self, archival_requests: list[dict]
    ) -> int:
        """Archive multiple resource attribute enum values and migrate attributes.

        Args:
            archival_requests: List of dicts with 'archived_id' and 'replacement_id' keys.

        Returns:
            Total number of resource attributes migrated.
        """
        request = BatchArchiveResourceAttributeEnumValuesRequest()
        for req in archival_requests:
            archival = BatchArchiveResourceAttributeEnumValuesRequest.EnumValueArchival(
                archived_enum_value_id=req["archived_id"],
                replacement_enum_value_id=req["replacement_id"],
            )
            request.archival_requests.append(archival)

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchArchiveResourceAttributeEnumValues(request)
        return cast(
            "BatchArchiveResourceAttributeEnumValuesResponse", response
        ).total_resource_attributes_migrated

    async def batch_unarchive_resource_attribute_enum_values(
        self, enum_value_ids: list[str]
    ) -> None:
        """Unarchive multiple resource attribute enum values.

        Args:
            enum_value_ids: List of resource attribute enum value IDs to unarchive.
        """
        request = BatchUnarchiveResourceAttributeEnumValuesRequest(
            resource_attribute_enum_value_ids=enum_value_ids
        )
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchUnarchiveResourceAttributeEnumValues(request)

    # Resource Attribute methods

    async def create_resource_attribute(
        self,
        key_id: str,
        entity_id: str,
        entity_type: int,
        resource_attribute_enum_value_id: str | None = None,
        boolean_value: bool | None = None,
        number_value: float | None = None,
    ) -> ResourceAttribute:
        """Create a new resource attribute.

        Args:
            key_id: The resource attribute key ID.
            entity_id: The entity ID.
            entity_type: The ResourceAttributeEntityType enum value.
            resource_attribute_enum_value_id: Enum value ID (if applicable).
            boolean_value: Boolean value (if applicable).
            number_value: Number value (if applicable).

        Returns:
            The created ResourceAttribute.
        """
        create = ResourceAttributeCreate(
            resource_attribute_key_id=key_id,
            entity_id=entity_id,
            entity_type=entity_type,
            resource_attribute_enum_value_id=resource_attribute_enum_value_id,
            boolean_value=boolean_value,
            number_value=number_value,
        )
        request = create.to_proto()

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).CreateResourceAttribute(request)
        grpc_attr = cast("CreateResourceAttributeResponse", response).resource_attribute
        return ResourceAttribute._from_proto(grpc_attr)

    async def batch_create_resource_attributes(
        self,
        key_id: str,
        entities: list[ResourceAttributeEntityIdentifier],
        resource_attribute_enum_value_id: str | None = None,
        boolean_value: bool | None = None,
        number_value: float | None = None,
    ) -> list[ResourceAttribute]:
        """Create resource attributes for multiple entities.

        Args:
            key_id: The resource attribute key ID.
            entities: List of entity identifiers.
            resource_attribute_enum_value_id: Enum value ID (if applicable).
            boolean_value: Boolean value (if applicable).
            number_value: Number value (if applicable).

        Returns:
            List of created ResourceAttributes.
        """
        request = BatchCreateResourceAttributesRequest(
            resource_attribute_key_id=key_id, entities=entities
        )
        if resource_attribute_enum_value_id is not None:
            request.resource_attribute_enum_value_id = resource_attribute_enum_value_id
        elif boolean_value is not None:
            request.boolean_value = boolean_value
        elif number_value is not None:
            request.number_value = number_value

        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchCreateResourceAttributes(request)
        grpc_attrs = cast("BatchCreateResourceAttributesResponse", response).resource_attributes
        return [ResourceAttribute._from_proto(attr) for attr in grpc_attrs]

    async def get_resource_attribute(self, attribute_id: str) -> ResourceAttribute:
        """Get a resource attribute by ID.

        Args:
            attribute_id: The resource attribute ID.

        Returns:
            The ResourceAttribute.
        """
        request = GetResourceAttributeRequest(resource_attribute_id=attribute_id)
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).GetResourceAttribute(request)
        grpc_attr = cast("GetResourceAttributeResponse", response).resource_attribute
        return ResourceAttribute._from_proto(grpc_attr)

    async def list_resource_attributes(
        self,
        *,
        page_size: int | None = None,
        page_token: str | None = None,
        query_filter: str | None = None,
        order_by: str | None = None,
        include_archived: bool = False,
    ) -> tuple[list[ResourceAttribute], str]:
        """List resource attributes with optional filtering and pagination.

        Args:
            page_size: The maximum number of attributes to return.
            page_token: A page token for pagination.
            query_filter: A CEL filter string.
            order_by: How to order the retrieved attributes.
            include_archived: Whether to include archived attributes.

        Returns:
            A tuple of (attributes, next_page_token).
        """
        request_kwargs: dict[str, Any] = {
            "include_archived": include_archived,
        }
        if page_size is not None:
            request_kwargs["page_size"] = page_size
        if page_token is not None:
            request_kwargs["page_token"] = page_token
        if query_filter is not None:
            request_kwargs["filter"] = query_filter
        if order_by is not None:
            request_kwargs["order_by"] = order_by

        request = ListResourceAttributesRequest(**request_kwargs)
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ListResourceAttributes(request)
        response = cast("ListResourceAttributesResponse", response)

        attrs = [
            ResourceAttribute._from_proto(attr) for attr in response.resource_attributes
        ]
        return attrs, response.next_page_token

    async def list_all_resource_attributes(
        self,
        *,
        query_filter: str | None = None,
        order_by: str | None = None,
        include_archived: bool = False,
        max_results: int | None = None,
    ) -> list[ResourceAttribute]:
        """List all resource attributes with optional filtering.

        Args:
            query_filter: A CEL filter string.
            order_by: How to order the retrieved attributes.
            include_archived: Whether to include archived attributes.
            max_results: Maximum number of results to return.

        Returns:
            A list of all matching attributes.
        """
        return await self._handle_pagination(
            self.list_resource_attributes,
            kwargs={"include_archived": include_archived, "query_filter": query_filter},
            order_by=order_by,
            max_results=max_results,
        )

    async def list_resource_attributes_by_entity(
        self,
        entity_id: str,
        entity_type: int,
        *,
        page_size: int | None = None,
        page_token: str | None = None,
        include_archived: bool = False,
    ) -> tuple[list[ResourceAttribute], str]:
        """List resource attributes for a specific entity.

        Args:
            entity_id: The entity ID.
            entity_type: The ResourceAttributeEntityType enum value.
            page_size: The maximum number of attributes to return.
            page_token: A page token for pagination.
            include_archived: Whether to include archived attributes.

        Returns:
            A tuple of (attributes, next_page_token).
        """
        entity = ResourceAttributeEntityIdentifier(entity_id=entity_id, entity_type=entity_type)
        request_kwargs: dict[str, Any] = {
            "entity": entity,
            "include_archived": include_archived,
        }
        if page_size is not None:
            request_kwargs["page_size"] = page_size
        if page_token is not None:
            request_kwargs["page_token"] = page_token

        request = ListResourceAttributesByEntityRequest(**request_kwargs)
        response = await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ListResourceAttributesByEntity(request)
        response = cast("ListResourceAttributesByEntityResponse", response)

        attrs = [
            ResourceAttribute._from_proto(attr) for attr in response.resource_attributes
        ]
        return attrs, response.next_page_token

    async def list_all_resource_attributes_by_entity(
        self,
        entity_id: str,
        entity_type: int,
        *,
        include_archived: bool = False,
        max_results: int | None = None,
    ) -> list[ResourceAttribute]:
        """List all resource attributes for a specific entity.

        Args:
            entity_id: The entity ID.
            entity_type: The ResourceAttributeEntityType enum value.
            include_archived: Whether to include archived attributes.
            max_results: Maximum number of results to return.

        Returns:
            A list of all matching attributes.
        """
        return await self._handle_pagination(
            self.list_resource_attributes_by_entity,
            kwargs={
                "entity_id": entity_id,
                "entity_type": entity_type,
                "include_archived": include_archived,
            },
            max_results=max_results,
        )

    async def archive_resource_attribute(self, attribute_id: str) -> None:
        """Archive a resource attribute.

        Args:
            attribute_id: The resource attribute ID to archive.
        """
        request = ArchiveResourceAttributeRequest(resource_attribute_id=attribute_id)
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).ArchiveResourceAttribute(request)

    async def unarchive_resource_attribute(self, attribute_id: str) -> None:
        """Unarchive a resource attribute.

        Args:
            attribute_id: The resource attribute ID to unarchive.
        """
        request = UnarchiveResourceAttributeRequest(resource_attribute_id=attribute_id)
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).UnarchiveResourceAttribute(request)

    async def batch_archive_resource_attributes(self, attribute_ids: list[str]) -> None:
        """Archive multiple resource attributes.

        Args:
            attribute_ids: List of resource attribute IDs to archive.
        """
        request = BatchArchiveResourceAttributesRequest(resource_attribute_ids=attribute_ids)
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchArchiveResourceAttributes(request)

    async def batch_unarchive_resource_attributes(self, attribute_ids: list[str]) -> None:
        """Unarchive multiple resource attributes.

        Args:
            attribute_ids: List of resource attribute IDs to unarchive.
        """
        request = BatchUnarchiveResourceAttributesRequest(resource_attribute_ids=attribute_ids)
        await self._grpc_client.get_stub(
            ResourceAttributeServiceStub
        ).BatchUnarchiveResourceAttributes(request)

